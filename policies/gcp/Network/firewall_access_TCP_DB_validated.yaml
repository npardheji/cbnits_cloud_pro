policies:
    - name: firewall_access_TCP_DB_validated
      description: |
        GCP firewall accepts from "0.0.0.0/0" 
      resource: gcp.firewall
      # mode:
      #   type: gcp-audit
      #   methods: 
      #     - AutoTag

      filters:
        - and:
          - type: value
            key: direction
            value: INGRESS

          - type: value
            key: sourceRanges
            value: 
              - "0.0.0.0/0"

          - type: value
            key:  allowed[].IPProtocol
            op: contains
            value:  "tcp"
          
          - type: value
            key:  allowed[].ports
            op: contains
            value:
              - "5432" # should be edited to the desired DB port/ postgres used here

      # actions:
      #   - type: modify
      #     sourceRanges: 
      #         - "0.0.0.0/0"
          